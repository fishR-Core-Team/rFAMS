<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Quick Introduction to ggplot2 for rFAMS • rFAMS</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="ggplot_for_rFAMS_files/libs/quarto-html/popper.min.js"></script><script src="ggplot_for_rFAMS_files/libs/quarto-html/tippy.umd.min.js"></script><link href="ggplot_for_rFAMS_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ggplot_for_rFAMS_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quick Introduction to ggplot2 for rFAMS">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rFAMS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-demonstrations" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Demonstrations</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-demonstrations">
<li><a class="dropdown-item" href="../articles/MakeLH.html">Create life history object</a></li>
    <li><a class="dropdown-item" href="../articles/YPR_fixedMLL.html">Estimate yield based on a single minimum length limit</a></li>
    <li><a class="dropdown-item" href="../articles/YPR_VarMLL.html">Estimate yield based on multiple minimum length limit</a></li>
    <li><a class="dropdown-item" href="../articles/YPR_slotLimit.html">Estimate yield based on a slot length limit</a></li>
    <li><a class="dropdown-item" href="../articles/dpmBH.html">Simulate a population using the dynamic pool model</a></li>
    <li><a class="dropdown-item" href="../articles/ggplot_for_rFAMS.html">ggplot2 for rFAMS</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-explanations" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Explanations</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-explanations">
<li><a class="dropdown-item" href="../articles/YPR_FAMSvRICKER.html">Comparing FAMS and Ricker YPR Equations</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../news/index.html" aria-label="See package news"><span class="fa fa-newspaper"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Goto rFAMS home"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fishR-Core-Team/rFAMS" aria-label="Goto rFAMS github page"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Quick Introduction to ggplot2 for rFAMS</h1>

      <p class="author">Derek Ogle</p>
      <p class="date">2026-02-07</p>

      <small class="dont-index">Source: <a href="https://github.com/fishR-Core-Team/rFAMS/blob/HEAD/vignettes/articles/ggplot_for_rFAMS.qmd" class="external-link"><code>vignettes/articles/ggplot_for_rFAMS.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <section class="section level2"><h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>rFAMS</code> package documentation and demonsration articles display a number of graphs that were created with <code>ggplot2</code>. Those sources are not meant to teach how to make the graphs but rather to show what kind of visualizations may come from <code>rFAMS</code> output. In this article, we provide a <strong>very quick</strong> introduction to <code>ggplot2</code> that we hope can help you get started understanding those examples and making your own graphics from <code>rFAMS</code> output.</p>
<p>Our descriptions here will be terse as we attempt to make this introduction very quick. The online <code>ggplot2</code> book (<a href="https://ggplot2-book.org/" class="external-link">here</a>) is an invaluable resource for in-depth learning of <code>ggplot2</code>. There is also a wealth of other <code>ggplot2</code> resources available that can be found with a quick internet search (or using an LLM). We do provide links to some specific parts of the <code>ggplot2</code> book in side notes.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;For example, &lt;a href="https://ggplot2-book.org/introduction.html" class="external-link"&gt;see here&lt;/a&gt; for the philosophy of &lt;code&gt;ggplot2&lt;/code&gt;.&lt;/p&gt;'><sup>1</sup></a></p>
<p>The objective of this article is to provide a basic introduction to <code>ggplot2</code> for those with little to no experience using it. There is a lot of code in this article as we show how to build many of the graphs one step at a time. Thus, many code chunks are simply repeats of previous code chunks. Please keep in mind that most graphs can be constructed simply from the code at or near the end of each section.</p>
</section><section class="section level2"><h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>The following packages are used in this article.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/fishR-Core-Team/rFAMS/" class="external-link">rFAMS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>   <span class="co"># for data wrangling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>   <span class="co"># for data wrangling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co"># for plotting</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://eliocamp.github.io/metR/" class="external-link">metR</a></span><span class="op">)</span>    <span class="co"># for geom_contour2 &amp; geom_contour_fill</span></span></code></pre></div>
</div>
<p>This article will use the results from modeling a single minimum length limit to a population across varying conditional natural and fishing mortality rates as produced by <code><a href="../reference/yprBH_minLL_fixed.html">yprBH_minLL_fixed()</a></code> from <code>rFAMS</code>. Specifics for this function are not described here as the focus here is on graphing those results. See <a href="https://fishr-core-team.github.io/rFAMS/reference/yprBH_minLL_fixed.html">this documentation</a> and <a href="https://fishr-core-team.github.io/rFAMS/articles/YPR_fixedMLL.html">this article</a> for a complete description of how to use <code><a href="../reference/yprBH_minLL_fixed.html">yprBH_minLL_fixed()</a></code> and interpret the results that are returned. The code below produces a wide array of results (yield; numbers of fish harvested, died, at various lengths; etc.) along with given values for the simulation that are stored in a data.frame assigned to the name <code>minLL_1</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Declare life history parameters to be used below</span></span>
<span><span class="va">LH</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeLH.html">makeLH</a></span><span class="op">(</span>N0<span class="op">=</span><span class="fl">100</span>,tmax<span class="op">=</span><span class="fl">15</span>,Linf<span class="op">=</span><span class="fl">592</span>,K<span class="op">=</span><span class="fl">0.20</span>,t0<span class="op">=</span><span class="op">-</span><span class="fl">0.3</span>,LWalpha<span class="op">=</span><span class="op">-</span><span class="fl">5.528</span>,LWbeta<span class="op">=</span><span class="fl">3.273</span><span class="op">)</span></span>
<span><span class="co"># Declare lengths-of-interest to monitor</span></span>
<span><span class="va">lois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">250</span>,<span class="fl">300</span>,<span class="fl">350</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimate yield for minimum length limit of 225 &amp; various mortality rates</span></span>
<span><span class="va">minLL_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/yprBH_minLL_fixed.html">yprBH_minLL_fixed</a></span><span class="op">(</span>minLL<span class="op">=</span><span class="fl">225</span>,</span>
<span>                             cfmin<span class="op">=</span><span class="fl">0</span>,cfmax<span class="op">=</span><span class="fl">0.5</span>,cfinc<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>                             cmmin<span class="op">=</span><span class="fl">0.2</span>,cmmax<span class="op">=</span><span class="fl">0.6</span>,cminc<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>                             loi<span class="op">=</span><span class="va">lois</span>,lhparms<span class="op">=</span><span class="va">LH</span><span class="op">)</span></span></code></pre></div>
</div>
<p>The first six rows of this data.frame can be examined with <code><a href="https://rdrr.io/r/utils/head.html" class="external-link">head()</a></code>. Take special note of the variable names in this output (e.g., <code>yield</code>, <code>nharvest</code>, <code>cf</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">minLL_1</span><span class="op">)</span></span>
<span><span class="co">#&gt;      yield nharvest     ndie       nt       tr    avgwt   avglen   nAt200</span></span>
<span><span class="co">#&gt; 1     0.00  0.00000 62.71738 62.71738 2.090724      NaN      NaN 67.50249</span></span>
<span><span class="co">#&gt; 2 17132.15 20.11523 42.60215 62.71738 2.090724 851.7003 383.9381 67.50249</span></span>
<span><span class="co">#&gt; 3 21570.11 31.35869 31.35869 62.71738 2.090724 687.8512 359.6751 67.50249</span></span>
<span><span class="co">#&gt; 4 21599.41 38.58055 24.13683 62.71738 2.090724 559.8524 337.7455 67.50249</span></span>
<span><span class="co">#&gt; 5 20265.82 43.64985 19.06753 62.71738 2.090724 464.2816 318.9719 67.50249</span></span>
<span><span class="co">#&gt; 6 18623.38 47.44387 15.27351 62.71738 2.090724 392.5350 303.0249 67.50249</span></span>
<span><span class="co">#&gt;     nAt250   nAt300   nAt350 exploitation         F         M         Z    S</span></span>
<span><span class="co">#&gt; 1 57.96988 48.59772 39.41029   0.00000000 0.0000000 0.2231436 0.2231436 0.80</span></span>
<span><span class="co">#&gt; 2 55.85488 43.08372 31.64732   0.08980389 0.1053605 0.2231436 0.3285041 0.72</span></span>
<span><span class="co">#&gt; 3 53.58174 37.65684 24.76460   0.18000000 0.2231436 0.2231436 0.4462871 0.64</span></span>
<span><span class="co">#&gt; 4 51.11635 32.32635 18.75362   0.27066569 0.3566749 0.2231436 0.5798185 0.56</span></span>
<span><span class="co">#&gt; 5 48.41099 27.10403 13.60485   0.36190801 0.5108256 0.2231436 0.7339692 0.48</span></span>
<span><span class="co">#&gt; 6 45.39545 22.00526  9.30741   0.45388248 0.6931472 0.2231436 0.9162907 0.40</span></span>
<span><span class="co">#&gt;    cf  cm minLL  N0 Linf   K   t0 LWalpha LWbeta tmax notes</span></span>
<span><span class="co">#&gt; 1 0.0 0.2   225 100  592 0.2 -0.3  -5.528  3.273   15      </span></span>
<span><span class="co">#&gt; 2 0.1 0.2   225 100  592 0.2 -0.3  -5.528  3.273   15      </span></span>
<span><span class="co">#&gt; 3 0.2 0.2   225 100  592 0.2 -0.3  -5.528  3.273   15      </span></span>
<span><span class="co">#&gt; 4 0.3 0.2   225 100  592 0.2 -0.3  -5.528  3.273   15      </span></span>
<span><span class="co">#&gt; 5 0.4 0.2   225 100  592 0.2 -0.3  -5.528  3.273   15      </span></span>
<span><span class="co">#&gt; 6 0.5 0.2   225 100  592 0.2 -0.3  -5.528  3.273   15</span></span></code></pre></div>
</div>
</section><section class="section level2"><h2 id="data-consideration-i">Data Consideration I<a class="anchor" aria-label="anchor" href="#data-consideration-i"></a>
</h2>
<p>One question we may have with these data is how the number of fish harvested changes with conditional fishing mortality. This seems easy enough to plot <code>cf</code> on the x-axis and <code>nharvest</code> on the y-axis. However, <code>nharvest</code> is ultimately a function of both conditional fishing and conditional natural (i.e., <code>cm</code>) mortality and the <code>cf</code> values were repeated for different <code>cm</code> values. For example, the first 12 rows of the data.frame below, restricted to just <code>nharvest</code>, <code>cf</code>, and <code>cm</code> for clarity, show how <code>cf</code> ranges from 0.0 to 0.5 with <code>cm</code>=0.2, and then repeats for <code>cm</code>=0.3.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">minLL_1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cf</span>,<span class="va">cm</span>,<span class="va">nharvest</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">#&gt;     cf  cm nharvest</span></span>
<span><span class="co">#&gt; 1  0.0 0.2  0.00000</span></span>
<span><span class="co">#&gt; 2  0.1 0.2 20.11523</span></span>
<span><span class="co">#&gt; 3  0.2 0.2 31.35869</span></span>
<span><span class="co">#&gt; 4  0.3 0.2 38.58055</span></span>
<span><span class="co">#&gt; 5  0.4 0.2 43.64985</span></span>
<span><span class="co">#&gt; 6  0.5 0.2 47.44387</span></span>
<span><span class="co">#&gt; 7  0.0 0.3  0.00000</span></span>
<span><span class="co">#&gt; 8  0.1 0.3 10.81796</span></span>
<span><span class="co">#&gt; 9  0.2 0.3 18.25724</span></span>
<span><span class="co">#&gt; 10 0.3 0.3 23.71990</span></span>
<span><span class="co">#&gt; 11 0.4 0.3 27.93481</span></span>
<span><span class="co">#&gt; 12 0.5 0.3 31.32222</span></span></code></pre></div>
</div>
<p>Thus, it would be best to look at <code>nharvest</code> versus <code>cf</code> separately by values of <code>cm</code>. <code>ggplot2</code> can efficiently create a plot of <code>nharvest</code> versus <code>cf</code> with separate lines based on <code>cm</code>;<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See the &lt;a href="#conditional-relationships"&gt;Conditional Relationships&lt;/a&gt; section.&lt;/p&gt;'><sup>2</sup></a> however, for this quick introduction to <code>ggplot2</code> a simple data.frame restricted to just <code>cm==0.30</code> will be used. We will return to the larger data.frame later.</p>
<p>The code below creates a new data.frame (<code>tmp1</code>) from the original data.frame (<code>minLL_1</code>) by filtering (with <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code> from <code>dplyr</code>) to include only those results where <code>cm</code> was “near” 0.30. The <code><a href="https://dplyr.tidyverse.org/reference/near.html" class="external-link">dplyr::near()</a></code> is used here rather than the conditional equality statement of <code>cm==0.30</code> to guard against possible floating point issues related to how 0.30 might be stored in the data.frame.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Real numbers such as 0.30 may actually be stored as something very slightly different than 0.30 when many decimals are considered due to machine accuracy issues.&lt;/p&gt;"><sup>3</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp1</span> <span class="op">&lt;-</span> <span class="va">minLL_1</span> <span class="op">|&gt;</span>                    <span class="co"># all variables in returned in tmp1</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/near.html" class="external-link">near</a></span><span class="op">(</span><span class="va">cm</span>,<span class="fl">0.30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tmp1</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cf</span>,<span class="va">cm</span>,<span class="va">nharvest</span><span class="op">)</span>        <span class="co"># but display only 3 for simplicity</span></span>
<span><span class="co">#&gt;    cf  cm nharvest</span></span>
<span><span class="co">#&gt; 1 0.0 0.3  0.00000</span></span>
<span><span class="co">#&gt; 2 0.1 0.3 10.81796</span></span>
<span><span class="co">#&gt; 3 0.2 0.3 18.25724</span></span>
<span><span class="co">#&gt; 4 0.3 0.3 23.71990</span></span>
<span><span class="co">#&gt; 5 0.4 0.3 27.93481</span></span>
<span><span class="co">#&gt; 6 0.5 0.3 31.32222</span></span></code></pre></div>
</div>
<p>Generally speaking <code>ggplot2</code> works well to graph a single variable (e.g., histogram of yield) or one variable versus another (e.g., scatterplot of number harvested versus exploitation). To plot two variables versus another variable generally requires further data manipulation before graphing with <code>ggplot2</code>. So, for example, if you wanted to plot <code>nharvest</code> <em>and</em> the number that died (<code>ndie</code>) against <code>cf</code> then further data manipulation is generally required (see <a href="#data-consideration-iii">Data Consideration III</a>).</p>
</section><section class="section level2"><h2 id="simple-relationships">Simple Relationships<a class="anchor" aria-label="anchor" href="#simple-relationships"></a>
</h2>
<p>Graphs are constructed with <code>ggplot2</code> in parts that are then “added” together to make the complete graph. In its simplest form, a <code>ggplot2</code> graph needs three parts: <em>data</em>, a description of which variables should be used in the graph and what they should represent (i.e., a <em>mapping</em> of <em>aesthetics</em>), and a layer that describes how the variables description is rendered (usually through a <code>geom_</code>).<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See &lt;a href="https://ggplot2-book.org/getting-started.html#sec-basic-use" class="external-link"&gt;here&lt;/a&gt; for more complete description.&lt;/p&gt;'><sup>4</sup></a></p>
<p>In the example below the data.frame containing the variables for the graph is declared in <code>data=tmp1</code> in <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code>.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Code using &lt;code&gt;ggplot2&lt;/code&gt; to make graphs will always begin with &lt;code&gt;&lt;a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link"&gt;ggplot()&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;'><sup>5</sup></a> Which variables to use and what they represent is declared within <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code> which is given to <code>mapping=</code>.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The &lt;code&gt;data=&lt;/code&gt; and &lt;code&gt;mapping=&lt;/code&gt; names can be dropped if the arguments stay in this order. We, however, prefer to be explicit in our &lt;code&gt;&lt;a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link"&gt;ggplot()&lt;/a&gt;&lt;/code&gt; calls.&lt;/p&gt;'><sup>6</sup></a> In this case, <code>cf</code> will be displayed on the x-axis (because <code>x=</code>) and <code>nharvest</code> will be displayed on the y-axis (because <code>y=</code>). Here, these two variables will be represented as a layer that will form a line because <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line()</a></code> was “added” (i.e., the <code>+</code>) to the <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> object.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;We recommend having each component of the &lt;code&gt;ggplot2&lt;/code&gt; graph on separate lines as shown here.&lt;/p&gt;"><sup>7</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-5-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
<p>It is possible to have the same data displayed as a layer of points by using <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point()</a></code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-6-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
<p>It is also possible to declare <code>data=</code> and <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code> within the <code>geom_</code> rather than in <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-7-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
<p>This is generally only desirable, though, if <em>different</em> data are to be used in the different layers. For example, the code below shows <code>nharvest</code> as a line and <code>ndie</code> as points against <code>cf</code>. Note that this is done here only to demonstrate that different data or variables can be used in different layers. This will be useful in some situations but more efficient methods exist in <code>ggplot2</code> to construct this type of graph.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See &lt;a href="#separate-relationships"&gt;Separate Relationships&lt;/a&gt; section.&lt;/p&gt;'><sup>8</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">ndie</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-8-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
<p>As a general rule, the <code>data=</code> and <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code> that will be the same for all layers of a single graph should be declared in <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code>. Other aesthetics that differ among layers may be declared in the layer’s <code>geom_</code>. For example, the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code> in <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> below suggests that all layers will use <code>data=tmp1</code> and map <code>cf</code> to <code>x</code>, but <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line()</a></code> will map <code>nharvest</code> to <code>y</code> and <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point()</a></code> will map <code>ndie</code> to <code>y</code>. In other words, the parts that are the same for each layer are in <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> whereas those that differ between layers are in the separate <code>geom_</code>s.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">nharvest</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">ndie</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-9-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
<p>Let’s return to examining just <code>nharvest</code> against <code>cf</code>. As illustrated above, multiple layers (i.e., <code>geom_</code>s) may be used in one graph. Here the relationship is shown as a line and with points.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-10-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
<p>Various characteristics of a layer can be manipulated within the <code>geom_</code>. Here, the width of the line is increased in <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line()</a></code> and the size of the points is increased in <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point()</a></code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">exploitation</span>,y<span class="op">=</span><span class="va">nharvest</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-11-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
<p>All other aspects of the graph can also be manipulated. For example, characteristics of the x- and y-axes can be controlled with <code>scale_</code> functions. The <code>scale_</code> functions will be appended with an <code>x</code> or <code>y</code> depending on which axis is to be manipulated and with other words like <code>continuous</code>, <code>discrete</code>, or <code>datetime</code> depending on the type of data on the axis. Here, both the x- and y-axes have continuous data, so those axes will be manipulated with <code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous()</a></code>, respectively. Below the titles of the axes are modified with a string in <code>name=</code>.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Note that axes titles can also be declared with &lt;code&gt;&lt;a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link"&gt;labs()&lt;/a&gt;&lt;/code&gt;. We tend to use the &lt;code&gt;scale_&lt;/code&gt; functions as we often also manipulate other characteristics of the axes.&lt;/p&gt;'><sup>9</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Number Harvested (out of 100)"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-12-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
<p>Other aspects of the axes can be manipulated through the <code>scale_</code> functions,<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See &lt;a href="https://ggplot2-book.org/scales-position.html" class="external-link"&gt;here&lt;/a&gt; for specifics on axis manipulations.&lt;/p&gt;'><sup>10</sup></a> with a few common changes illustrated here. Values for where tick-marks are shown can be modified with <code>breaks=</code>. Here the breaks for the x-axis are set with a sequence of numbers from 0 to 0.5 in increments of 0.1 and the y-axis is from 0 to 50 in increments of 5.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Note that &lt;code&gt;breaks=&lt;/code&gt; does not set the limits of the axes, so the &lt;code&gt;breaks=&lt;/code&gt; can be set to outside the range of the axis but breaks outside the range will not be shown.&lt;/p&gt;"><sup>11</sup></a> The range or extent of the axis may be set with <code>limits=</code>. Here the y-axis limits are set at a minimum of 0 and a maximum of <code>NA</code>, which means that the maximum will still be defined automatically for the data. Finally, the default for <code>ggplot2</code> is to provide a buffer to the ends of the axes (i.e., they will extend past their defined limits). This has the unfortunate look of having zero on an axis to not appear as far left or as far down as it should. This behavior can be adjusted with <code>expand=</code> (using <code><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion()</a></code>). Below the expansion is removed (i.e., 0) at the lower and set to 2% (i.e., 0.02) at the upper ends of each axis.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Number Harvested (out of 100)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span>,<span class="fl">5</span><span class="op">)</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,</span>
<span>                     expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-13-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
<p>Finally, the default “theme” for the plot can be changed by “adding” a <code>theme_XXX()</code> to the graph. Here, a simple black-and-white theme is added with <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic()</a></code>, which removes the “grayish” background and gridlines inside the plot region and darkens the axis scales and text among other things.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See &lt;a href="https://ggplot2-book.org/themes.html#sec-themes" class="external-link"&gt;here&lt;/a&gt; for more options for built-in themes.&lt;/p&gt;'><sup>12</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Number Harvested (out of 100)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span>,<span class="fl">5</span><span class="op">)</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,</span>
<span>                     expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-14-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
</section><section class="section level2"><h2 id="data-consideration-ii">Data Consideration II<a class="anchor" aria-label="anchor" href="#data-consideration-ii"></a>
</h2>
<p>All of the variables returned by <code><a href="../reference/yprBH_minLL_fixed.html">yprBH_minLL_fixed()</a></code> are numeric, except for <code>notes</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">minLL_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    30 obs. of  27 variables:</span></span>
<span><span class="co">#&gt;  $ yield       : num  0 17132 21570 21599 20266 ...</span></span>
<span><span class="co">#&gt;  $ nharvest    : num  0 20.1 31.4 38.6 43.6 ...</span></span>
<span><span class="co">#&gt;  $ ndie        : num  62.7 42.6 31.4 24.1 19.1 ...</span></span>
<span><span class="co">#&gt;  $ nt          : num  62.7 62.7 62.7 62.7 62.7 ...</span></span>
<span><span class="co">#&gt;  $ tr          : num  2.09 2.09 2.09 2.09 2.09 ...</span></span>
<span><span class="co">#&gt;  $ avgwt       : num  NaN 852 688 560 464 ...</span></span>
<span><span class="co">#&gt;  $ avglen      : num  NaN 384 360 338 319 ...</span></span>
<span><span class="co">#&gt;  $ nAt200      : num  67.5 67.5 67.5 67.5 67.5 ...</span></span>
<span><span class="co">#&gt;  $ nAt250      : num  58 55.9 53.6 51.1 48.4 ...</span></span>
<span><span class="co">#&gt;  $ nAt300      : num  48.6 43.1 37.7 32.3 27.1 ...</span></span>
<span><span class="co">#&gt;  $ nAt350      : num  39.4 31.6 24.8 18.8 13.6 ...</span></span>
<span><span class="co">#&gt;  $ exploitation: num  0 0.0898 0.18 0.2707 0.3619 ...</span></span>
<span><span class="co">#&gt;  $ F           : num  0 0.105 0.223 0.357 0.511 ...</span></span>
<span><span class="co">#&gt;  $ M           : num  0.223 0.223 0.223 0.223 0.223 ...</span></span>
<span><span class="co">#&gt;  $ Z           : num  0.223 0.329 0.446 0.58 0.734 ...</span></span>
<span><span class="co">#&gt;  $ S           : num  0.8 0.72 0.64 0.56 0.48 0.4 0.7 0.63 0.56 0.49 ...</span></span>
<span><span class="co">#&gt;  $ cf          : num  0 0.1 0.2 0.3 0.4 0.5 0 0.1 0.2 0.3 ...</span></span>
<span><span class="co">#&gt;  $ cm          : num  0.2 0.2 0.2 0.2 0.2 0.2 0.3 0.3 0.3 0.3 ...</span></span>
<span><span class="co">#&gt;  $ minLL       : num  225 225 225 225 225 225 225 225 225 225 ...</span></span>
<span><span class="co">#&gt;  $ N0          : num  100 100 100 100 100 100 100 100 100 100 ...</span></span>
<span><span class="co">#&gt;  $ Linf        : num  592 592 592 592 592 592 592 592 592 592 ...</span></span>
<span><span class="co">#&gt;  $ K           : num  0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 ...</span></span>
<span><span class="co">#&gt;  $ t0          : num  -0.3 -0.3 -0.3 -0.3 -0.3 -0.3 -0.3 -0.3 -0.3 -0.3 ...</span></span>
<span><span class="co">#&gt;  $ LWalpha     : num  -5.53 -5.53 -5.53 -5.53 -5.53 ...</span></span>
<span><span class="co">#&gt;  $ LWbeta      : num  3.27 3.27 3.27 3.27 3.27 ...</span></span>
<span><span class="co">#&gt;  $ tmax        : num  15 15 15 15 15 15 15 15 15 15 ...</span></span>
<span><span class="co">#&gt;  $ notes       : chr  "" "" "" "" ...</span></span></code></pre></div>
</div>
<p>There are times when we would rather a variable be categorical,<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;In &lt;code&gt;ggplot2&lt;/code&gt; these are called “discrete.”&lt;/p&gt;"><sup>13</sup></a> in the sense that it has labels that represent groups. For example, below we will create a graph that shows the relationship between <code>nharvest</code> and <code>cf</code> with separate lines for each value of <code>cm</code>. As <code>cm</code> is numeric the default colors chosen will appear continuous (i.e., different shades of the same general color) rather than discrete (i.e., distinctly different colors).</p>
<p>A variable can be converted to categorical<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;In R these are called “factors”.&lt;/p&gt;"><sup>14</sup></a> by submitting the original variable to <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor()</a></code>. Below this conversion is within <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> from <code>dplyr</code> so that a new variable is created in the data.frame. In this case, the original <code>cm</code> variable that is numeric still exists and a new <code>fcm</code> variable that is a factor is created in the same data.frame.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">minLL_1</span> <span class="op">&lt;-</span> <span class="va">minLL_1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>fcm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">cm</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># checking classes of the cm/fcm variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">minLL_1</span><span class="op">$</span><span class="va">cm</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "numeric"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">minLL_1</span><span class="op">$</span><span class="va">fcm</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "factor"</span></span></code></pre></div>
</div>
</section><section class="section level2"><h2 id="conditional-relationships">Conditional Relationships<a class="anchor" aria-label="anchor" href="#conditional-relationships"></a>
</h2>
<section class="level2"><h3 id="multiple-lines">Multiple Lines<a class="anchor" aria-label="anchor" href="#multiple-lines"></a>
</h3>
<p>Lines may be printed for different groups by mapping the color aesthetic to the variable that defines the groups. For example, the “factored” version of the conditional natural mortality variable (i.e., <code>fcm</code>) is mapped to <code>color=</code> in <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code> to define colors to be used for separate lines based on the “categories” in <code>cfm</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">minLL_1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span>,color<span class="op">=</span><span class="va">fcm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-17-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
<p>The separation of colors will carry through to the points if <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point()</a></code> is added.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">minLL_1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span>,color<span class="op">=</span><span class="va">fcm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-18-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
<p>It is also possible to have colors for just the lines (and not the points) by moving the color aesthetic into <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line()</a></code> (and not having a color aesthetic in <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point()</a></code> or in <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code>. Recall that mappings declared in <code>gggplot()</code> will be used for all ensuing <code>geom_</code>s, whereas those declared in a <code>geom_</code> will only be used for that <code>geom_</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">minLL_1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">fcm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-19-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
<p>Of course, the other modifications made above can also be made here.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Note that we returned to the graph with just the lines and no points.&lt;/p&gt;"><sup>15</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">minLL_1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span>,color<span class="op">=</span><span class="va">fcm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Number Harvested (out of 100)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span>,<span class="fl">5</span><span class="op">)</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,</span>
<span>                     expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-20-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
<p>The colors used can be changed with one of the <code>scale_color_</code> functions.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See &lt;a href="https://ggplot2-book.org/scales-colour#sec-colour-discrete" class="external-link"&gt;here&lt;/a&gt; for how to modify discrete colors.&lt;/p&gt;'><sup>16</sup></a> Here, for example, the line colors will follow a grey scale.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">minLL_1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span>,color<span class="op">=</span><span class="va">fcm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Number Harvested (out of 100)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span>,<span class="fl">5</span><span class="op">)</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,</span>
<span>                     expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_grey.html" class="external-link">scale_color_grey</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-21-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
<p>The “name” printed at the top of the legend can be modified with <code>name=</code> in the <code>scale_color_</code> function. It can be removed completely by using <code>name=NULL</code> as shown below. In addition, the labels for the groups can be changed using <code>labels=</code> in the <code>scale_color_</code> function. For example, here I append “cm=” to each <code>cm</code> value.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">minLL_1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span>,color<span class="op">=</span><span class="va">fcm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Number Harvested (out of 100)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span>,<span class="fl">5</span><span class="op">)</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,</span>
<span>                     expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_grey.html" class="external-link">scale_color_grey</a></span><span class="op">(</span>name<span class="op">=</span><span class="cn">NULL</span>,labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"cm="</span>,<span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">minLL_1</span><span class="op">$</span><span class="va">fcm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-22-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
<p>Finally, various characteristics of the legend can be controlled within <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme()</a></code>.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See &lt;a href="https://ggplot2-book.org/themes.html#legend-elements" class="external-link"&gt;here&lt;/a&gt; for description of legend characteristics that can be modified in &lt;code&gt;&lt;a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link"&gt;theme()&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;'><sup>17</sup></a> Here, the legend is moved to the top-left corner of the plot region.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See &lt;a href="https://ggplot2-book.org/scales-colour.html#sec-legend-layout" class="external-link"&gt;here&lt;/a&gt; for how to position legends.&lt;/p&gt;'><sup>18</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">minLL_1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span>,color<span class="op">=</span><span class="va">fcm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Number Harvested (out of 100)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span>,<span class="fl">5</span><span class="op">)</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,</span>
<span>                     expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_grey.html" class="external-link">scale_color_grey</a></span><span class="op">(</span>name<span class="op">=</span><span class="cn">NULL</span>,labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"cm="</span>,<span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">minLL_1</span><span class="op">$</span><span class="va">fcm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>,<span class="fl">0.77</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-23-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
<p>For completeness, separate lines can also be made using a continuous variable. In these instances though the name of the continuous variables must also be used with <code>group=</code> in <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code>. For example, a graph where the color of the lines come from a continous scale based on the value of <code>cm</code> is created below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">minLL_1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span>,color<span class="op">=</span><span class="va">cm</span>,group<span class="op">=</span><span class="va">cm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Number Harvested (out of 100)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span>,<span class="fl">5</span><span class="op">)</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,</span>
<span>                     expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>,<span class="fl">0.77</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-24-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
<p>The colors used can also be adjusted with a <code>scale_color_</code> function, though the set of functions that can be used with a continuous variable is different than those that can be used with a categorical variable.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See &lt;a href="https://ggplot2-book.org/scales-colour.html#sec-colour-continuous" class="external-link"&gt;here&lt;/a&gt; for setting continuous colors.&lt;/p&gt;'><sup>19</sup></a></p>
</section><section class="level2"><h3 id="facets">Facets<a class="anchor" aria-label="anchor" href="#facets"></a>
</h3>
<p>An alternative is examinine the relationship between two variables separated by groups by making separate plots for each group. In <code>ggplot2</code> this is called <em>facetting</em> and is accomplished by adding <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap()</a></code> with the name of the grouping variable within <code><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars()</a></code>.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Note that &lt;code&gt;&lt;a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link"&gt;theme_bw()&lt;/a&gt;&lt;/code&gt; is used here as &lt;code&gt;&lt;a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link"&gt;theme_classic()&lt;/a&gt;&lt;/code&gt; looked “odd” with the facets.&lt;/p&gt;'><sup>20</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">minLL_1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Number Harvested (out of 100)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span>,<span class="fl">5</span><span class="op">)</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,</span>
<span>                     expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">fcm</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-25-1.png" class="quarto-figure quarto-figure-center" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Many aspects of the facets can be controlled,<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See &lt;a href="https://ggplot2-book.org/facet.html" class="external-link"&gt;here&lt;/a&gt; for specifics.&lt;/p&gt;'><sup>21</sup></a> but are not illustrated here as we do not use much faceting in the <code>rFams</code> documentation.</p>
</section></section><section class="section level2"><h2 id="data-consideration-iii">Data Consideration III<a class="anchor" aria-label="anchor" href="#data-consideration-iii"></a>
</h2>
<p>A separate issue arises if we want to examine the relationship of more than one variable against a single other variable. Suppose, for example, that we want to examine the number of fish that survived to several specific lengths at various levels of conditional fishing mortality. Doing this requires the variables shown below.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The original data.frame is isolated here to just those variables for visual simplicity. &lt;code&gt;cm&lt;/code&gt; is also included for later use.&lt;/p&gt;"><sup>22</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp2</span> <span class="op">&lt;-</span> <span class="va">minLL_1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cf</span>,<span class="va">cm</span>,<span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"nAt"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tmp2</span><span class="op">)</span></span>
<span><span class="co">#&gt;    cf  cm   nAt200   nAt250   nAt300   nAt350</span></span>
<span><span class="co">#&gt; 1 0.0 0.2 67.50249 57.96988 48.59772 39.41029</span></span>
<span><span class="co">#&gt; 2 0.1 0.2 67.50249 55.85488 43.08372 31.64732</span></span>
<span><span class="co">#&gt; 3 0.2 0.2 67.50249 53.58174 37.65684 24.76460</span></span>
<span><span class="co">#&gt; 4 0.3 0.2 67.50249 51.11635 32.32635 18.75362</span></span>
<span><span class="co">#&gt; 5 0.4 0.2 67.50249 48.41099 27.10403 13.60485</span></span>
<span><span class="co">#&gt; 6 0.5 0.2 67.50249 45.39545 22.00526  9.30741</span></span></code></pre></div>
</div>
<p>To address the question would require plotting <code>nAt200</code> against <code>cf</code>, <code>nAt250</code> against <code>cf</code>, etc. As demonstrated in the <a href="#simple-relationships">Simple Relationships</a> section, this can be accomplished with multiple <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line()</a></code>s each with its own <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code>. However, this is cumbersome and, more importantly, does not generalize well. This issue can be better handled with some data wrangling prior to making the plot.</p>
<p>These data are in <em>wide</em><a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Sometimes called cross-sectional format.&lt;/p&gt;"><sup>23</sup></a> format where each row of the data.frame contains multiple observations to be plotted. For example, one instance of <code>nAt200</code> against <code>cf</code> and one instance of <code>nAt250</code> against <code>cf</code> are in the same row.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;This, of course, can be said for every row in the data.frame.&lt;/p&gt;"><sup>24</sup></a> Before plotting, wide format data needs to be transformed to <em>long</em><a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Sometimes called longitudinal or tidy format.&lt;/p&gt;"><sup>25</sup></a> format data where each row contains only one observation to be plotted.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;There are many descriptions of wide- and long-format data on-line; &lt;a href="https://dataanalysis.co.zw/wide-data-vs-long-data-why-format-matters-more-than-you-think/" class="external-link"&gt;here is one&lt;/a&gt;.&lt;/p&gt;'><sup>26</sup></a></p>
<p>Wide format data can be transformed or “pivoted” to long format data with <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer()</a></code> from <code>tidyr</code>. The first arguments to <code>pivot_longer</code> are names of the variables that need to be converted from the multiple columns in wide format to multiple rows in long format. In this case, the <code>nAtXXX</code> variables need to be moved from columns in the original wide format data.frame to multiple rows (and one column, with a corresponding “label” column) in the new long format data.frame. The variables can be chosen in a variety of ways – e.g., by listing them individually, by excluding those variables not to use with an <code>!</code> (e.g., <code>!cf</code>), or using one of the helper functions supplied with <code>tidyr</code>. As all of these variables begin with <code>nAt</code>, <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with()</a></code> is used below to select them.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Here this is the same as using &lt;code&gt;nAt200,nAt250,nAt300,nAt350&lt;/code&gt; or &lt;code&gt;!cf,!cm&lt;/code&gt; as the first arguments.&lt;/p&gt;"><sup>27</sup></a> A name for the variable that will contain the values from these columns in the new long format data.frame is given to <code>values_to=</code>. A name for the variable that will contain “labels” for what these values represent is given to <code>names_to=</code>.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The result returned by &lt;code&gt;&lt;a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link"&gt;pivot_longer()&lt;/a&gt;&lt;/code&gt; is a &lt;code&gt;tibble&lt;/code&gt;. We prefer data.frames so force this with &lt;code&gt;&lt;a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link"&gt;as.data.frame()&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;'><sup>28</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp2long</span> <span class="op">&lt;-</span> <span class="va">tmp2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"nAt"</span><span class="op">)</span>,</span>
<span>                      values_to<span class="op">=</span><span class="st">"n"</span>,</span>
<span>                      names_to<span class="op">=</span><span class="st">"Length"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tmp2long</span><span class="op">)</span></span>
<span><span class="co">#&gt;    cf  cm Length        n</span></span>
<span><span class="co">#&gt; 1 0.0 0.2 nAt200 67.50249</span></span>
<span><span class="co">#&gt; 2 0.0 0.2 nAt250 57.96988</span></span>
<span><span class="co">#&gt; 3 0.0 0.2 nAt300 48.59772</span></span>
<span><span class="co">#&gt; 4 0.0 0.2 nAt350 39.41029</span></span>
<span><span class="co">#&gt; 5 0.1 0.2 nAt200 67.50249</span></span>
<span><span class="co">#&gt; 6 0.1 0.2 nAt250 55.85488</span></span></code></pre></div>
</div>
<p>In this long format data.frame each row now corresponds to one observation – i.e., one <code>n</code>-<code>cf</code> pair with a corresponding label describing the length that the observation corresponds to.</p>
<p>The <code>Length</code> variable in this case has awkward names; they would look better with the <code>nAt</code> dropped to leave just the length value (though it will be a character). This common prefix can be dropped by using <code>names_prefix=</code> with the common prefix in the original <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer()</a></code> call.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp2long</span> <span class="op">&lt;-</span> <span class="va">tmp2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"nAt"</span><span class="op">)</span>,</span>
<span>                      values_to<span class="op">=</span><span class="st">"n"</span>,</span>
<span>                      names_to<span class="op">=</span><span class="st">"Length"</span>,names_prefix<span class="op">=</span><span class="st">"nAt"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tmp2long</span><span class="op">)</span></span>
<span><span class="co">#&gt;    cf  cm Length        n</span></span>
<span><span class="co">#&gt; 1 0.0 0.2    200 67.50249</span></span>
<span><span class="co">#&gt; 2 0.0 0.2    250 57.96988</span></span>
<span><span class="co">#&gt; 3 0.0 0.2    300 48.59772</span></span>
<span><span class="co">#&gt; 4 0.0 0.2    350 39.41029</span></span>
<span><span class="co">#&gt; 5 0.1 0.2    200 67.50249</span></span>
<span><span class="co">#&gt; 6 0.1 0.2    250 55.85488</span></span></code></pre></div>
</div>
</section><section class="section level2"><h2 id="separate-relationships">Separate Relationships<a class="anchor" aria-label="anchor" href="#separate-relationships"></a>
</h2>
<p>Once the data are in long format, the process to examine the relationships of multiple variables against a single other variable is basically the same process as that described for <a href="#conditional-relationships">Conditional Relationships</a>. Here we first examine the numbers of fish surviving to the four lengths against <code>cf</code> only for when <code>cm</code> is 0.30.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp3</span> <span class="op">&lt;-</span> <span class="va">tmp2long</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/near.html" class="external-link">near</a></span><span class="op">(</span><span class="va">cm</span>,<span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp3</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">n</span>,color<span class="op">=</span><span class="va">Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Number Surviving (out of 100)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span>,<span class="fl">5</span><span class="op">)</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,</span>
<span>                     expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-30-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
<p>The same relationship can also be examined for the separate values of <code>cm</code> via faceting.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp2long</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">n</span>,color<span class="op">=</span><span class="va">Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Number Surviving (out of 100)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">70</span>,<span class="fl">10</span><span class="op">)</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,</span>
<span>                     expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">cm</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-31-1.png" class="quarto-figure quarto-figure-center" width="576"></p>
</figure>
</div>
</div>
</div>
</section><section class="section level2"><h2 id="more-complex-relationships">More Complex Relationships<a class="anchor" aria-label="anchor" href="#more-complex-relationships"></a>
</h2>
<p>The wealth of results returned by <code>rFAMS</code> allows for exploration of more complex relationships. However, these relationships become harder to visualize.</p>
<p>As an example for a more complex relationship to explore, suppose that interest is in the relationship between number of fish that survived to 350 mm (for example) as a function of <strong>both</strong> <code>cf</code> and <code>cm</code>. For this situation, a new data.frame that is restricted to the data that corresponds to just the numbers at 350 mm is first created from the long data.frame created above.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The full data.frame will be explored further below.&lt;/p&gt;"><sup>29</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp4</span> <span class="op">&lt;-</span> <span class="va">tmp2long</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Length</span><span class="op">==</span><span class="st">"350"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>A contour plot that connects with a line the same values for one variable at each point of the other two variables is one way to examine a three-dimensional relationship. Contour plots can be made with <code><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html" class="external-link">geom_contour()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html" class="external-link">geom_contour_filled()</a></code> from <code>ggplot2</code>. However, we have found that <code><a href="https://eliocamp.github.io/metR/reference/geom_contour2.html" class="external-link">geom_contour2()</a></code> and <code><a href="https://eliocamp.github.io/metR/reference/geom_contour_fill.html" class="external-link">geom_contour_fill()</a></code> from <code>metR</code> to be more useful as they allow the contour lines to be more easily labeled. All of these functions require mapping the variable that will define the contour lines to <code>z=</code> in <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code>. For example, a basic plot with contour lines defined by the number of fish surviving to 350 mm (i.e., <code>n</code>) relative to values of <code>cf</code> and <code>cm</code> is shown below.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The lines would be more “smooth” if more (i.e., smaller increment) &lt;code&gt;cf&lt;/code&gt; and &lt;code&gt;cm&lt;/code&gt; values had been used.&lt;/p&gt;"><sup>30</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp4</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">cm</span>,z<span class="op">=</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">metR</span><span class="fu">::</span><span class="fu"><a href="https://eliocamp.github.io/metR/reference/geom_contour2.html" class="external-link">geom_contour2</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-33-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
<p>Labeling these contours requires setting <code>label=</code> in <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code> in <code><a href="https://eliocamp.github.io/metR/reference/geom_contour2.html" class="external-link">geom_contour2()</a></code> to <code>after_stat(level)</code> where <code>level</code> is calculated behind-the-scenes by <code><a href="https://eliocamp.github.io/metR/reference/geom_contour2.html" class="external-link">geom_contour2()</a></code> to be values connected by the contour lines.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;It is best to let &lt;code&gt;&lt;a href="https://eliocamp.github.io/metR/reference/geom_contour2.html" class="external-link"&gt;geom_contour2()&lt;/a&gt;&lt;/code&gt; define these as they may depend on settings like &lt;code&gt;breaks=&lt;/code&gt;, &lt;code&gt;bin_width=&lt;/code&gt;, etc.&lt;/p&gt;'><sup>31</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp4</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">cm</span>,z<span class="op">=</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">metR</span><span class="fu">::</span><span class="fu"><a href="https://eliocamp.github.io/metR/reference/geom_contour2.html" class="external-link">geom_contour2</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">level</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-34-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
<p>In this example, it would better to have more of the contours labelled. The combined use of <code>skip=0</code> (which indicates that no contours should be skipped when placing the labels) and <code>label.placer=label_placer_n(n=1)</code> (which finds the flattest place to put one label on the contour) helps to label all or most of the contours.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp4</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">cm</span>,z<span class="op">=</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">metR</span><span class="fu">::</span><span class="fu"><a href="https://eliocamp.github.io/metR/reference/geom_contour2.html" class="external-link">geom_contour2</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">level</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      label.placer<span class="op">=</span><span class="fu"><a href="https://eliocamp.github.io/metR/reference/label_placers.html" class="external-link">label_placer_n</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,skip<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-35-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
<p>Of course, the usual modifications can be made to make the graph more visually appealing.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp4</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">cm</span>,z<span class="op">=</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">metR</span><span class="fu">::</span><span class="fu"><a href="https://eliocamp.github.io/metR/reference/geom_contour2.html" class="external-link">geom_contour2</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">level</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      label.placer<span class="op">=</span><span class="fu"><a href="https://eliocamp.github.io/metR/reference/label_placers.html" class="external-link">label_placer_n</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,skip<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Natural Mortality (cm)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-36-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
<p>The patterns may be more evident if the contours are “filled” with a gradient of colors with <code><a href="https://eliocamp.github.io/metR/reference/geom_contour_fill.html" class="external-link">geom_contour_fill()</a></code> from <code>metR</code>. Note that <code><a href="https://eliocamp.github.io/metR/reference/geom_contour_fill.html" class="external-link">geom_contour_fill()</a></code> was placed before <code><a href="https://eliocamp.github.io/metR/reference/geom_contour2.html" class="external-link">geom_contour2()</a></code> so that the contour lines would be placed on top of the fill colors.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp4</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">cm</span>,z<span class="op">=</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">metR</span><span class="fu">::</span><span class="fu"><a href="https://eliocamp.github.io/metR/reference/geom_contour_fill.html" class="external-link">geom_contour_fill</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">metR</span><span class="fu">::</span><span class="fu"><a href="https://eliocamp.github.io/metR/reference/geom_contour2.html" class="external-link">geom_contour2</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">level</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      label.placer<span class="op">=</span><span class="fu"><a href="https://eliocamp.github.io/metR/reference/label_placers.html" class="external-link">label_placer_n</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                      skip<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Natural Mortality (cm)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-37-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
<p>However, the default blue color scheme is a bit overwhelming. A different color palette can be used by adding <code><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_color_continuous()</a></code> with <code>palette=</code>. The example below demonstrates an “orange-red” pallete.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See &lt;a href="https://r-graph-gallery.com/38-rcolorbrewers-palettes.html" class="external-link"&gt;here&lt;/a&gt; for a list of possible choices for &lt;code&gt;palette=&lt;/code&gt;.&lt;/p&gt;'><sup>32</sup></a> Note that the legend (related to the fill colors) was removed with <code>theme(legend.position="none")</code> because it is redundant with the contour labels.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp4</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">cm</span>,z<span class="op">=</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">metR</span><span class="fu">::</span><span class="fu"><a href="https://eliocamp.github.io/metR/reference/geom_contour_fill.html" class="external-link">geom_contour_fill</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">metR</span><span class="fu">::</span><span class="fu"><a href="https://eliocamp.github.io/metR/reference/geom_contour2.html" class="external-link">geom_contour2</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">level</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      label.placer<span class="op">=</span><span class="fu"><a href="https://eliocamp.github.io/metR/reference/label_placers.html" class="external-link">label_placer_n</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                      skip<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Natural Mortality (cm)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_fill_continuous</a></span><span class="op">(</span>palette<span class="op">=</span><span class="st">"OrRd"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-38-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
<p>It is also possible to use faceting to examine this relationship for the numbers of fish that survived to the other lengths. Make special note of the return to using the <code>tmp2long</code> data.frame here.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp2long</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">cm</span>,z<span class="op">=</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">metR</span><span class="fu">::</span><span class="fu"><a href="https://eliocamp.github.io/metR/reference/geom_contour_fill.html" class="external-link">geom_contour_fill</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">metR</span><span class="fu">::</span><span class="fu"><a href="https://eliocamp.github.io/metR/reference/geom_contour2.html" class="external-link">geom_contour2</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">level</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      label.placer<span class="op">=</span><span class="fu"><a href="https://eliocamp.github.io/metR/reference/label_placers.html" class="external-link">label_placer_n</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                      skip<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Natural Mortality (cm)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_fill_continuous</a></span><span class="op">(</span>palette<span class="op">=</span><span class="st">"OrRd"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">Length</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-39-1.png" class="quarto-figure quarto-figure-center" width="528"></p>
</figure>
</div>
</div>
</div>
</section><section class="section level2"><h2 id="miscellaneous-things">Miscellaneous Things<a class="anchor" aria-label="anchor" href="#miscellaneous-things"></a>
</h2>
<section class="level2"><h3 id="titles">Titles<a class="anchor" aria-label="anchor" href="#titles"></a>
</h3>
<p>While not appropriate for publications, there may be a reason to include titles on your <code>ggplot2</code> graph. For example a main title, a subtitle, and a caption (defaults to lower-right) is included below with <code>title=</code>, <code>subtitle=</code> and <code>caption=</code> in <code><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs()</a></code>.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See &lt;a href="https://ggplot2-book.org/annotations.html#sec-titles" class="external-link"&gt;here&lt;/a&gt; for more about &lt;code&gt;&lt;a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link"&gt;labs()&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;'><sup>33</sup></a> Aspects (size, color, etc.) for these items can be modified with <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme()</a></code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Number Harvested (out of 100)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span>,<span class="fl">5</span><span class="op">)</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,</span>
<span>                     expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Harvest Relasionship to Fishing Mortality"</span>,</span>
<span>       subtitle<span class="op">=</span><span class="st">"Minimum length limit of 225 mm &amp; cm=0.30"</span>,</span>
<span>       caption<span class="op">=</span><span class="st">"Results from rFAMS"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-40-1.png" class="quarto-figure quarto-figure-center" width="384"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="custom-themes">Custom Themes<a class="anchor" aria-label="anchor" href="#custom-themes"></a>
</h3>
<p>Themes allow you to control many of the non-data related aspects of your graphs. Some complete themes are built-in to <code>ggplot2</code>. For example, the <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw()</a></code> that were used in the previous examples. These themes can be modified with arguments to <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme()</a></code>. For example, <code>theme(legend.position="none")</code> was used previously to remove the legend from the graph.</p>
<p>Many aspects of a graph can be controlled through <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme()</a></code>.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See &lt;a href="https://ggplot2-book.org/themes.html#sec-theme-elements" class="external-link"&gt;here&lt;/a&gt; for all elements that can be odified with &lt;code&gt;&lt;a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link"&gt;theme()&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;'><sup>34</sup></a> For example, the simple plot of <code>nharvest</code> versus <code>cf</code> from the <a href="#simple-relationships">Simple Relationships</a> section is modified below by adding the <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw()</a></code> theme but then modifying that to</p>
<ul>
<li>changing the color of the plot panel border to black,</li>
<li>removing the major and minor grid lines in the plot panel,</li>
<li>increasing the size and changing the color to black of the axis title and text, and</li>
<li>changing the axis lines to black.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Number Harvested (out of 100)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span>,<span class="fl">5</span><span class="op">)</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,</span>
<span>                     expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    panel.border<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span>,</span>
<span>    panel.grid.major<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span>,color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span>,</span>
<span>    axis.title<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span>,color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span>,</span>
<span>    axis.line<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-41-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
<p>Even this simple examples shows how the code to produce a graph can become quite long if many elements are changed in <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme()</a></code>. In addition, you will likely want to use the same modifications in all of your plots, which could entail a lot of cut-and-paste. Fortunately, your theming decisions can be saved to a custom thee function and then applied in one line to all of your graphs. As an example, the code below creates a custom theme called <code>theme_rFAMS_ex()</code> that encapsulates the modifications above.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theme_rFAMS_ex</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    panel.border<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span>,</span>
<span>    panel.grid.major<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span>,color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span>,</span>
<span>    axis.title<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span>,color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span>,</span>
<span>    axis.line<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<p>Once this code is run then it can be applied to any graph.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp1</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">nharvest</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Number Harvested (out of 100)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span>,<span class="fl">5</span><span class="op">)</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,</span>
<span>                     expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_rFAMS_ex</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-43-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp2long</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">n</span>,color<span class="op">=</span><span class="va">Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Number Surviving (out of 100)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">70</span>,<span class="fl">10</span><span class="op">)</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,</span>
<span>                     expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_rFAMS_ex</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">cm</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-44-1.png" class="quarto-figure quarto-figure-center" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Additional elements for a specific graph can still be changed with <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme()</a></code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp2long</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cf</span>,y<span class="op">=</span><span class="va">n</span>,color<span class="op">=</span><span class="va">Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Conditional Fishing Mortality (cf)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span>,expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Number Surviving (out of 100)"</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">70</span>,<span class="fl">10</span><span class="op">)</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,</span>
<span>                     expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_rFAMS_ex</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.85</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">cm</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-45-1.png" class="quarto-figure quarto-figure-center" width="576"></p>
</figure>
</div>
</div>
</div>
<p><a href="https://fishr-core-team.github.io/fishR/blog/posts/2022-12-22_AFS_Style_Figures/" class="external-link">This fishR post</a> demonstrates how to build and use a custom theme for creating graphs that meet AFS publication requirements.</p>
</section><section class="level2"><h3 id="returned-lists-of-data-frames">Returned Lists of data.frames<a class="anchor" aria-label="anchor" href="#returned-lists-of-data-frames"></a>
</h3>
<p>The dynamic pool model implemented in <code><a href="../reference/dpmBH_MinLL_fixed.html">dpmBH_minLL_fixed()</a></code> returns an object that is a list of two data.frames, which is more complex than what is returned from other functions in <code>rFAMS</code>. However, accessing these two data.frames is fairly simple and is illustrated here.</p>
<p>The code below is copied from this <a href="https://fishr-core-team.github.io/rFAMS/articles/dpmBH.html">this article</a> that demonstrates how to use <code><a href="../reference/dpmBH_MinLL_fixed.html">dpmBH_minLL_fixed()</a></code>.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See &lt;a href="https://fishr-core-team.github.io/rFAMS/reference/dpmBH_minLL_fixed.html"&gt;the documentation for &lt;code&gt;dpmBH_minLL_fixed()&lt;/code&gt;&lt;/a&gt; for more details).&lt;/p&gt;'><sup>35</sup></a> The results were assigned to <code>minLL_2</code> in the last line.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set number of simulation years</span></span>
<span><span class="va">simyears</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="co"># set minimum length limit value</span></span>
<span><span class="va">minLL</span> <span class="op">&lt;-</span> <span class="fl">400</span></span>
<span><span class="co"># create life history parameter object</span></span>
<span><span class="va">LH</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeLH.html">makeLH</a></span><span class="op">(</span>N0<span class="op">=</span><span class="fl">100</span>,tmax<span class="op">=</span><span class="fl">15</span>,Linf<span class="op">=</span><span class="fl">1349.5</span>,K<span class="op">=</span><span class="fl">0.111</span>,t0<span class="op">=</span><span class="fl">0.065</span>,LWalpha<span class="op">=</span><span class="op">-</span><span class="fl">5.2147</span>,LWbeta<span class="op">=</span><span class="fl">3.153</span><span class="op">)</span></span>
<span><span class="co"># set mortality matrices</span></span>
<span><span class="va">cm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.18</span>,<span class="op">(</span><span class="va">LH</span><span class="op">$</span><span class="va">tmax</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="va">simyears</span><span class="op">)</span>,nrow<span class="op">=</span><span class="va">simyears</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.33</span>,<span class="op">(</span><span class="va">LH</span><span class="op">$</span><span class="va">tmax</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="va">simyears</span><span class="op">)</span>,nrow<span class="op">=</span><span class="va">simyears</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># create a recruitment vector</span></span>
<span><span class="va">rec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genRecruits.html">genRecruits</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"fixed"</span>,nR<span class="op">=</span><span class="fl">1000</span>,simyears<span class="op">=</span><span class="va">simyears</span><span class="op">)</span></span>
<span><span class="co"># run the DPM model of a 400 mm minimum length limit for 40 years</span></span>
<span><span class="co"># assume this is for landlocked Striped Bass</span></span>
<span><span class="va">minLL_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmBH_MinLL_fixed.html">dpmBH_minLL_fixed</a></span><span class="op">(</span>simyears<span class="op">=</span><span class="va">simyears</span>,minLL<span class="op">=</span><span class="va">minLL</span>,</span>
<span>                             cf<span class="op">=</span><span class="va">cf</span>,cm<span class="op">=</span><span class="va">cm</span>,rec<span class="op">=</span><span class="va">rec</span>,lhparms<span class="op">=</span><span class="va">LH</span>,matchRicker<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                             species<span class="op">=</span><span class="st">"Striped Bass"</span>,group<span class="op">=</span><span class="st">"landlocked"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>The results in <code>minLL_2</code> consist of two data.frames – <code>sumbyAge</code> and <code>sumbyYear</code> – which are simulation summarized arranged by age and by year.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">minLL_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "sumbyAge"  "sumbyYear"</span></span></code></pre></div>
</div>
<p>These data.frames can be accessed by appending a <code>$</code> followed by the data.frame name to <code>minLL_2</code>. For example, the first six rows of the <code>sumbyAge</code> data.frame are shown below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">minLL_2</span><span class="op">$</span><span class="va">sumbyAge</span><span class="op">)</span></span>
<span><span class="co">#&gt;   year yc age   length     weight    nstart exploitation expect_nat_death   cf</span></span>
<span><span class="co">#&gt; 1    1  1   0   0.0000    0.00000 1000.0000    0.0000000        0.0000000 0.00</span></span>
<span><span class="co">#&gt; 2    2  1   1 133.0349   30.35037 1000.0000    0.0000000        0.1800000 0.33</span></span>
<span><span class="co">#&gt; 3    3  1   2 260.8383  253.58225  820.0000    0.0000000        0.1800000 0.33</span></span>
<span><span class="co">#&gt; 4    4  1   3 375.2145  798.00101  672.4000    0.3012967        0.1493033 0.33</span></span>
<span><span class="co">#&gt; 5    5  1   4 477.5741 1707.32249  405.4091    0.3012967        0.1493033 0.33</span></span>
<span><span class="co">#&gt; 6    6  1   5 569.1797 2968.94019  222.7318    0.3012967        0.1493033 0.33</span></span>
<span><span class="co">#&gt;     cm         F         M         Z      S   biomass  nharvest      ndie</span></span>
<span><span class="co">#&gt; 1 0.00 0.0000000 0.0000000 0.0000000 1.0000      0.00   0.00000   0.00000</span></span>
<span><span class="co">#&gt; 2 0.18 0.0000000 0.1984509 0.1984509 0.8200  30350.37   0.00000 180.00000</span></span>
<span><span class="co">#&gt; 3 0.18 0.0000000 0.1984509 0.1984509 0.8200 207937.44   0.00000 147.60000</span></span>
<span><span class="co">#&gt; 4 0.18 0.4004776 0.1984509 0.5989285 0.5494 536575.88 158.28150 108.70941</span></span>
<span><span class="co">#&gt; 5 0.18 0.4004776 0.1984509 0.5989285 0.5494 692164.07 122.14843  60.52891</span></span>
<span><span class="co">#&gt; 6 0.18 0.4004776 0.1984509 0.5989285 0.5494 661277.27  67.10835  33.25458</span></span>
<span><span class="co">#&gt;      yield minLL   N0   Linf     K    t0 LWalpha LWbeta tmax notes</span></span>
<span><span class="co">#&gt; 1      0.0   400 1000 1349.5 0.111 0.065 -5.2147  3.153   15      </span></span>
<span><span class="co">#&gt; 2      0.0   400 1000 1349.5 0.111 0.065 -5.2147  3.153   15      </span></span>
<span><span class="co">#&gt; 3      0.0   400 1000 1349.5 0.111 0.065 -5.2147  3.153   15      </span></span>
<span><span class="co">#&gt; 4 205139.2   400 1000 1349.5 0.111 0.065 -5.2147  3.153   15      </span></span>
<span><span class="co">#&gt; 5 274569.3   400 1000 1349.5 0.111 0.065 -5.2147  3.153   15      </span></span>
<span><span class="co">#&gt; 6 245109.6   400 1000 1349.5 0.111 0.065 -5.2147  3.153   15</span></span></code></pre></div>
</div>
<p>Accessing this data.frame in this way means that it can be used just like any other data.frame. For example, the first year-class in this data.frame is isolated below and a graph of the number harvested by age is created.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmpX</span> <span class="op">&lt;-</span> <span class="va">minLL_2</span><span class="op">$</span><span class="va">sumbyAge</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">yc</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmpX</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">age</span>,y<span class="op">=</span><span class="va">nharvest</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Age"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Number Harvested"</span>,</span>
<span>                     expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-49-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="other-types-of-graphs">Other Types of Graphs<a class="anchor" aria-label="anchor" href="#other-types-of-graphs"></a>
</h3>
<p>All of the examples above used either <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line()</a></code> or <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point()</a></code> to visualize the relationship between two variables. While it is not possible to show all possible graphs that can be constructed with <code>ggplot2</code>, there are many types of graphics that can be made and may be appropriate in these or other situations.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See &lt;a href="https://ggplot2-book.org/individual-geoms.html" class="external-link"&gt;here&lt;/a&gt; for other possible layer types.&lt;/p&gt;'><sup>36</sup></a></p>
<p>For example, the number harvested at each age shown in the previous section is probably better viewed as a bar chart. A bar chart is constructed using <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar()</a></code>. However, the default behavior of <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar()</a></code> is to count the number of items of <code>y=</code> for <code>x=</code> and then plot those counts as the height of the bar. In this example, the “counts” or height of the bar is already summarized in the variable provided to <code>y=</code> (i.e., <code>nharvest</code>). Use <code>stat="identity"</code> in <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar()</a></code> to over-ride the default counting and simply use the values in <code>y=</code> for the bar heights. The example below also outlines the bars in black (with <code>color=</code>) and fills them with a light gray (with <code>fill=</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmpX</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">age</span>,y<span class="op">=</span><span class="va">nharvest</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>,color<span class="op">=</span><span class="st">"black"</span>,fill<span class="op">=</span><span class="st">"lightgray"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Age"</span>,</span>
<span>                     expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Number Harvested"</span>,</span>
<span>                     expand<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggplot_for_rFAMS_files/figure-html/unnamed-chunk-50-1.png" class="quarto-figure quarto-figure-center" width="720"></p>
</figure>
</div>
</div>
</div>
</section></section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jason C. Doll, Derek H. Ogle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
