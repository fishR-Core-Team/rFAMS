---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# FAMS

<!-- badges: start -->
<!-- badges: end -->

Fisheries Analysis and Modeling Simulator in R

## Purpose

To recreate and expand/improve upon the FAMS/FAST software functionality for equilibrium and dynamic pool models, utilizing existing fishR and FSA components wherever possible

## Status

The package currently replicates all yield per recruit and dynamic pool modeling in FAMS with the exception of spawning potential ratio. That function will be added at a later date. Life history parameters can be estimated using FSA.

## Process 

### Equilibrium Modeling

1. Initial package development completed
2. Add spawning potential ratio
3. Incorporate suggestions from the fisheries community.

### Dynamic Pool Modeling

1. Complete
2. Add spawning potential ratio
3. Incorporate suggestions from the fisheries community.

### RShiny Development

1. Initial development completed
2. Build a Shiny app for testing different length regulation scenarios.

## Installation

The [most recent stable version](https://cloud.r-project.org/package=rFAMS) from CRAN may be installed with

```r
install.packages("rFAMS")
```

The [development version](https://github.com/fishR-Core-Team/rFAMS) may be installed from GitHub with

``` r
# install.packages("devtools")
devtools::install_github("fishR-Core-Team/rFAMS")
```
You may need R Tools installed on your system to install the development version from GitHub. See the instructions for ([R Tools for Windows](https://cran.r-project.org/bin/windows/Rtools/) or [R Tools for Mac OS X](https://cran.r-project.org/bin/macosx/tools/)).

&nbsp;

### Questions / Comments / Problems or Contributions
Report questions, comments, or bug reports on the [issues page](https://github.com/fishR-Core-Team/rFAMS/issues).

We are always looking for others to contribute to **FSA**. Please feel free to make a pull request via GitHub or to contact the maintainers.

Please adhere to the [Code of Conduct](https://fishr-core-team.github.io/rFAMS/CODE_OF_CONDUCT.html).

## Example

This is a basic example which shows you how simulate yield based on a slot limit with variable cf and variable cm:

```{r example}
#Load other required packages for organizing output and plotting
library(rFAMS)
library(ggplot2)
library(dplyr)
library(metR)
library(tidyr)

# Custom theme for plots (to make look nice)
theme_FAMS <- function(...) {
  theme_bw() +
  theme(
    panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
    axis.text=element_text(size=14,color="black"),
    axis.title=element_text(size=16,color="black"),
    axis.title.y=element_text(angle=90),
    axis.line=element_line(color="black"),
    panel.border=element_blank()
  )
}

# Life history parameters to be used below
LH <- makeLH(N0=100,tmax=15,Linf=592,K=0.20,t0=-0.3,LWalpha=-5.528,LWbeta=3.273)

#Estimate yield
Res_1 <- yprBH_SlotLL(recruitmentTL=200,lowerSL=250,upperSL=325,
                      cfunder=0.25,cfin=0.6,cfabove=0.15,cmmin=0.3,cmmax=0.6,cminc=0.05,
                      lhparms=LH)

Res_1

# Plot results
# Total Yield vs Conditional Natural Mortality (cm)
ggplot(data=Res_1,mapping=aes(x=cm,y=TotalYield)) +
 geom_point() +
 geom_line() +
 labs(y="Total Yield (g)",x="Conditional Natural Mortality (cm)") +
 theme_FAMS()


# Yield under, in, and above the slot limit vs Conditional Natural Mortality (cm)
# Select columns for plotting
plot_data <- Res_1 %>%
 select(cm, yieldUnder, yieldIn, yieldAbove) %>%
 pivot_longer(!cm, names_to="YieldCat",values_to="Yield")

# Generate plot
ggplot(data=plot_data,mapping=aes(x=cm,y=Yield,group=YieldCat,color=YieldCat)) +
 geom_point() +
 scale_color_discrete(name="Yield",labels=c("Above SL","In SL","Under SL"))+
 geom_line() +
 labs(y="Total Yield (g)",x="Conditional Natural Mortality (cm)") +
 theme_FAMS() +
 theme(legend.position = "top")+
 guides(color=guide_legend(title="Yield"))
```
